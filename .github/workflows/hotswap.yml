name: Use HotSwap on GH Actions

env:
  JBR_VERSION: 'jbr_jcef-21.0.3-linux-x64-b509.4'

on:
  push:
    branches: [ "main" ]
  pull_request:
    branches: [ "main" ]

jobs:
  hotswap:
    runs-on: ubuntu-latest
    steps:
      - name: Set up JDK ${inputs.java-version}
        uses: actions/setup-java@v4
        with:
          java-version: '21'
          distribution: 'temurin'
          cache: maven
      - uses: stCarolas/setup-maven@v5
        with:
          maven-version: '3.9.6'
      - uses: actions/checkout@v4
      - name: Build
        run: mvn install
      - name: Download and extract JBR
        run: |
          wget -q https://cache-redirector.jetbrains.com/intellij-jbr/${JBR_VERSION}.tar.gz
          tar -xzf ${JBR_VERSION}.tar.gz
      - name: Set JAVA_HOME
        run: echo "JAVA_HOME=`pwd`/${JBR_VERSION}" >> $GITHUB_ENV
      - name: Add JBR to PATH
        run: echo "PATH=$JAVA_HOME/bin:$PATH" >> $GITHUB_ENV
      - name: Check Java version
        run: |
          java --version
          javac --version
      - name: Run using JBR
        run: mvn spring-boot:run
