name: Add PR comment

on:
  pull_request:
    branches: [ "main" ]

jobs:
  comment:
    name: Add PR comment
    runs-on: ubuntu-latest
    permissions:
      pull-requests: write
    steps:
    - name: Create test files
      run: touch screenshot1.png screenshot1.html screenshot2.png screenshot2.html
    - name: Check empty directory
      run: |
        echo "failed_list=`ls -m *.png`" >> $GITHUB_ENV
        echo "failed=`ls *.png | wc -l | bc`" >> $GITHUB_ENV
    - name: test
      run: echo ${{ env.failed }}
    - uses: mshick/add-pr-comment@v2
      with:
        status: ${{ (env.failed == 0 && 'success') || (env.failed > 0 && 'failure') }}
        refresh-message-position: true
        message-success: |
          Tests passed.
        message-failure: |
          Tests failed: ${{ env.failed }}.
          ##Failed tests##
          ${{ env.failed_list }}
   
